<!doctype html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" xmlns:tiles="http://www.thymeleaf.org">
<head>
    <meta charset="utf-8"/>
    <title>Example</title>
    <link href='https://fonts.googleapis.com/css?family=Open+Sans:300,600' rel='stylesheet' type='text/css'>
    <script>
        var require = {
            baseUrl: "../",
//            urlArgs: ""
            urlArgs: "bust=" + new Date().getTime()
        };
    </script>

    <script type="text/javascript" th:src="@{bimsurfer/lib/require.js}"></script>
    
    <script type="text/javascript">
    	import("http://localhost:3030/apps/bimserverjavascriptapi/bimserverclient.js").then((bimserverapi) => {
        	//alert(bimserverapi);
    		//console.log(bimserverapi);
    		
    		var api = new bimserverapi.default("http://localhost:3030");
    		api.init((api, info) => {
    			//console.log(api, info);
        		
        		window.BimServerClient = bimserverapi.default; 
        		window.BimServerApiPromise = bimserverapi.BimServerApiPromise; 
        		//resolve(bimserverapi);

    			require([
    				"bimsurfer/src/BimSurfer","bimsurfer/src/BimServerModelLoader","bimsurfer/src/StaticTreeRenderer","bimsurfer/src/MetaDataRenderer","bimsurfer/lib/domReady!"
                ], function (BimSurfer, BimServerModelLoader, StaticTreeRenderer, MetaDataRenderer) {
                    window.bimSurfer = new BimSurfer({
                        domNode: "fullPageContainer"
                    });
                    bimSurfer.load({
                        bimserver: "http://localhost:3030",
	                    username: "hamidrezaseifi@gmail.com",
	                    password: "Elec7342",
	                    poid: 131073,
	                    roid: 1,
	                    schema: "ifc2x3tc1" // < TODO: Deduce automatically
                    })
                            .then(function (model) {
                                // Model is now loaded and rendering.
                                // The following sections show what you can do with BIMSurfer at this point.
                                //...
                            });
                });
                    			
    		});
    	});
//        require([
            //"http://ec2-18-222-53-244.us-east-2.compute.amazonaws.com:8080/apps/bimserverjavascriptapi/bimserverclient.js"
//        ], function(api) {
            /*           
            Then from here I would instantate a BIMSurfer etc...
            
            require([
                "bimsurfer/src/BimSurfer"
            ], function (BimSurfer) {
                window.bimSurfer = new BimSurfer({
                    domNode: "fullPageContainer"
                });
                bimSurfer.load({
                    bimserver: "http://ec2-18-222-53-244.us-east-2.compute.amazonaws.com:8080",
                    username: "admin@admin.admin",
                    password: "admin",
                    poid: 131073,
                    roid: 1,
                    schema: "ifc2x3tc1" // < TODO: Deduce automatically
                })
                        .then(function (model) {
                            // Model is now loaded and rendering.
                            // The following sections show what you can do with BIMSurfer at this point.
                            //...
                        });
            });
            */
//        });
    </script>

</head>
<body>
<div id="info">
    <h1>Loading a model from a BIMServer</h1>
</div>
<div style="position: absolute; top: 0; left: 0; width:100%; height: 100%;" id="fullPageContainer"></div>
</body>
</html>